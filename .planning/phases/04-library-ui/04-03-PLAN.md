---
phase: 04-library-ui
plan: 03
type: execute
wave: 3
depends_on: ["04-02"]
files_modified:
  - src/app/descriptors/page.tsx
  - src/app/descriptors/components/FilterPanel.tsx
  - src/app/descriptors/components/ComparisonBar.tsx
  - src/app/descriptors/components/DescriptorList.tsx
  - src/components/ui/sheet.tsx
autonomous: true

must_haves:
  truths:
    - "Search page works on mobile without horizontal scroll"
    - "Filter panel collapses to drawer on mobile"
    - "Cards are readable on small screens"
    - "Comparison bar adapts to mobile width"
  artifacts:
    - path: "src/components/ui/sheet.tsx"
      provides: "Sheet/Drawer component for mobile filters"
      contains: "SheetContent"
    - path: "src/app/descriptors/components/FilterPanel.tsx"
      provides: "Responsive filter with mobile drawer"
      contains: "Sheet"
---

<objective>
Make the descriptor library fully responsive for mobile and tablet devices

Purpose: Ensure mobile-friendly experience (UI-08) with collapsible filters and readable layouts
Output: Sheet component for mobile filter drawer, responsive adjustments to all components
</objective>

<context>
@src/app/descriptors/page.tsx
@src/app/descriptors/components/FilterPanel.tsx
@src/app/descriptors/components/ComparisonBar.tsx
@src/app/descriptors/components/DescriptorList.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Radix Sheet and create component</name>
  <files>src/components/ui/sheet.tsx</files>
  <action>
Install Radix dialog (Sheet uses the same primitive):

```bash
# Already have @radix-ui/react-dialog from 04-01, so just create the Sheet component
```

Create Sheet component for mobile drawer:

```typescript
"use client";

import * as React from "react";
import * as SheetPrimitive from "@radix-ui/react-dialog";
import { cva, type VariantProps } from "class-variance-authority";
import { X } from "lucide-react";

import { cn } from "@/lib/utils";

const Sheet = SheetPrimitive.Root;
const SheetTrigger = SheetPrimitive.Trigger;
const SheetClose = SheetPrimitive.Close;
const SheetPortal = SheetPrimitive.Portal;

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
));
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;

const sheetVariants = cva(
  "fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
  {
    variants: {
      side: {
        top: "inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",
        bottom:
          "inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",
        left: "inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",
        right:
          "inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",
      },
    },
    defaultVariants: {
      side: "right",
    },
  }
);

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Content>,
  SheetContentProps
>(({ side = "right", className, children, ...props }, ref) => (
  <SheetPortal>
    <SheetOverlay />
    <SheetPrimitive.Content
      ref={ref}
      className={cn(sheetVariants({ side }), className)}
      {...props}
    >
      {children}
      <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </SheetPrimitive.Close>
    </SheetPrimitive.Content>
  </SheetPortal>
));
SheetContent.displayName = SheetPrimitive.Content.displayName;

const SheetHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-2 text-center sm:text-left",
      className
    )}
    {...props}
  />
);
SheetHeader.displayName = "SheetHeader";

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold text-foreground", className)}
    {...props}
  />
));
SheetTitle.displayName = SheetPrimitive.Title.displayName;

export {
  Sheet,
  SheetPortal,
  SheetOverlay,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetTitle,
};
```
  </action>
  <verify>
Sheet component exists and compiles.
  </verify>
  <done>Sheet component created</done>
</task>

<task type="auto">
  <name>Task 2: Make FilterPanel responsive with mobile drawer</name>
  <files>src/app/descriptors/components/FilterPanel.tsx</files>
  <action>
Update FilterPanel to:
1. Show as sidebar on desktop (md+)
2. Show as sheet/drawer triggered by button on mobile

Create a wrapper component that handles the responsive behavior:

- On mobile: Button that opens Sheet with filters
- On desktop: Render filters directly in sidebar

The filter content itself stays the same, just wrapped differently based on screen size.

Use a "Filters" button with filter icon that shows on mobile only.
  </action>
  <verify>
On mobile: Filter button shows, clicking opens drawer.
On desktop: Filters show in sidebar as before.
  </verify>
  <done>FilterPanel responsive with mobile drawer</done>
</task>

<task type="auto">
  <name>Task 3: Update page layout for responsive grid</name>
  <files>src/app/descriptors/page.tsx</files>
  <action>
Update the page layout:
1. On mobile: Single column, filter button above search
2. On desktop: Keep 4-column grid with sidebar

Adjust the grid classes:
- Remove the aside on mobile (filters move to drawer)
- Full width main content on mobile
- Add filter button trigger on mobile

The page should detect mobile and pass a prop to FilterPanel to control its mode.
  </action>
  <verify>
Mobile: Full width content, filter button visible.
Desktop: Sidebar layout as before.
  </verify>
  <done>Page layout responsive</done>
</task>

<task type="auto">
  <name>Task 4: Polish mobile styles</name>
  <files>src/app/descriptors/components/ComparisonBar.tsx, src/app/descriptors/components/DescriptorList.tsx</files>
  <action>
Fine-tune mobile styles:

1. **ComparisonBar**:
   - On mobile, stack vertically or reduce width
   - Truncate more aggressively on small screens
   - Ensure doesn't overflow viewport

2. **DescriptorCard**:
   - Ensure badges wrap properly
   - Text doesn't overflow
   - Checkbox accessible on touch

3. **General**:
   - Add proper padding/margins for touch targets
   - Ensure modals are scrollable and don't overflow
  </action>
  <verify>
No horizontal scroll on mobile.
All interactive elements are touch-friendly (min 44px).
Modals scroll properly on small screens.
  </verify>
  <done>Mobile polish complete</done>
</task>

</tasks>

<verification>
1. Test at 375px width (iPhone SE) - no horizontal scroll
2. Test at 768px width (tablet) - layout adjusts appropriately
3. Filter drawer opens/closes smoothly on mobile
4. Cards are readable and don't overflow
5. Comparison bar fits mobile width
6. Modals are scrollable and usable on mobile
7. TypeScript compiles without errors
</verification>

<success_criteria>
- Mobile-friendly layout (UI-08)
- Filter drawer on mobile
- No horizontal scroll at any breakpoint
- Touch-friendly interactive elements
- Readable text at all sizes
</success_criteria>

<output>
After completion, create `.planning/phases/04-library-ui/04-03-SUMMARY.md`
</output>
