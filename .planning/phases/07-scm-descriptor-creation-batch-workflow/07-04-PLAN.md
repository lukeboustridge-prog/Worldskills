---
phase: 07-scm-descriptor-creation-batch-workflow
plan: 04
type: execute
wave: 3
depends_on: ["07-02", "07-03"]
files_modified:
  - src/app/(dashboard)/hub/descriptors/my-descriptors/page.tsx
  - src/app/(dashboard)/hub/descriptors/my-descriptors/create/page.tsx
  - src/app/(dashboard)/hub/descriptors/my-descriptors/[id]/edit/page.tsx
  - src/components/descriptors/wsos-section-select.tsx
autonomous: true

must_haves:
  truths:
    - "SCM can view list of their own descriptors grouped by status"
    - "Draft batch section shows edit/delete buttons for each descriptor"
    - "Submit for Review button submits all drafts to SA"
    - "Create form has WSOS section dropdown with inline creation option"
    - "Edit form only works for DRAFT status descriptors"
    - "Success/error messages displayed via query params"
  artifacts:
    - path: "src/app/(dashboard)/hub/descriptors/my-descriptors/page.tsx"
      provides: "My Descriptors list page with batch UI"
      min_lines: 80
    - path: "src/app/(dashboard)/hub/descriptors/my-descriptors/create/page.tsx"
      provides: "Create descriptor form with WSOS section select"
      min_lines: 80
    - path: "src/app/(dashboard)/hub/descriptors/my-descriptors/[id]/edit/page.tsx"
      provides: "Edit draft descriptor form"
      min_lines: 60
    - path: "src/components/descriptors/wsos-section-select.tsx"
      provides: "WSOS section dropdown with inline creation"
      min_lines: 50
  key_links:
    - from: "my-descriptors/page.tsx"
      to: "getSCMDescriptors"
      via: "import from lib/scm-descriptors"
      pattern: "import.*getSCMDescriptors"
    - from: "my-descriptors/page.tsx"
      to: "submitBatchAction"
      via: "form action"
      pattern: "action=\\{submitBatchAction\\}"
    - from: "create/page.tsx"
      to: "createSCMDescriptorAction"
      via: "form action"
      pattern: "action=\\{createSCMDescriptorAction\\}"
---

<objective>
Build the SCM descriptor management UI with list page, create form, edit form, and WSOS section selector component.

Purpose: Enable SCMs to create descriptors linked to WSOS sections, manage their draft batch, and submit for SA review.

Output: Complete SCM descriptor UI at /hub/descriptors/my-descriptors with create and edit pages.
</objective>

<execution_context>
@.claude/get-shit-done/workflows/execute-plan.md
@.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/07-scm-descriptor-creation-batch-workflow/07-RESEARCH.md
@.planning/phases/07-scm-descriptor-creation-batch-workflow/07-02-SUMMARY.md
@.planning/phases/07-scm-descriptor-creation-batch-workflow/07-03-SUMMARY.md
@src/app/(dashboard)/settings/descriptors/page.tsx
@src/app/(dashboard)/settings/descriptors/create/page.tsx
@src/app/(dashboard)/settings/wsos-sections/form.tsx
@src/lib/wsos-sections.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create WSOS Section Select component with inline creation</name>
  <files>src/components/descriptors/wsos-section-select.tsx</files>
  <action>
Create new file `src/components/descriptors/wsos-section-select.tsx`:

```typescript
"use client";

import { useState, useTransition } from "react";
import { useDebouncedCallback } from "use-debounce";
import { Plus, Loader2 } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from "@/components/ui/dialog";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { DuplicateWarning } from "@/components/wsos/duplicate-warning";
import {
  checkSimilarSectionsAction,
  createWSOSSectionAction,
} from "@/app/(dashboard)/settings/wsos-sections/actions";
import type { WSOSSectionWithCreator, SimilarSection } from "@/lib/wsos-sections";

interface WSOSSectionSelectProps {
  sections: WSOSSectionWithCreator[];
  name: string;
  defaultValue?: string;
  required?: boolean;
  onSectionCreated?: () => void;
}

export function WSOSSectionSelect({
  sections,
  name,
  defaultValue,
  required = true,
  onSectionCreated,
}: WSOSSectionSelectProps) {
  const [selectedId, setSelectedId] = useState(defaultValue ?? "");
  const [createOpen, setCreateOpen] = useState(false);
  const [newName, setNewName] = useState("");
  const [similar, setSimilar] = useState<SimilarSection[]>([]);
  const [isChecking, setIsChecking] = useState(false);
  const [isPending, startTransition] = useTransition();

  const checkSimilar = useDebouncedCallback(async (value: string) => {
    if (value.length < 3) {
      setSimilar([]);
      setIsChecking(false);
      return;
    }
    setIsChecking(true);
    try {
      const results = await checkSimilarSectionsAction(value);
      setSimilar(results);
    } finally {
      setIsChecking(false);
    }
  }, 500);

  const handleNameChange = (value: string) => {
    setNewName(value);
    checkSimilar(value);
  };

  const handleCreateSection = async (formData: FormData) => {
    startTransition(async () => {
      // Create section via existing action
      await createWSOSSectionAction(formData);
      // Close dialog and trigger refresh
      setCreateOpen(false);
      setNewName("");
      setSimilar([]);
      // Parent should refresh sections list
      onSectionCreated?.();
    });
  };

  return (
    <div className="flex gap-2">
      {/* Hidden input for form submission */}
      <input type="hidden" name={name} value={selectedId} />

      <Select value={selectedId} onValueChange={setSelectedId}>
        <SelectTrigger className="flex-1">
          <SelectValue placeholder="Select WSOS section..." />
        </SelectTrigger>
        <SelectContent>
          {sections.map((section) => (
            <SelectItem key={section.id} value={section.id}>
              {section.name}
            </SelectItem>
          ))}
        </SelectContent>
      </Select>

      <Dialog open={createOpen} onOpenChange={setCreateOpen}>
        <DialogTrigger asChild>
          <Button type="button" variant="outline" size="icon" title="Create new section">
            <Plus className="h-4 w-4" />
          </Button>
        </DialogTrigger>
        <DialogContent>
          <DialogHeader>
            <DialogTitle>Create New WSOS Section</DialogTitle>
          </DialogHeader>
          <form action={handleCreateSection} className="space-y-4">
            <div className="space-y-2">
              <Label htmlFor="newSectionName">Section Name</Label>
              <div className="relative">
                <Input
                  id="newSectionName"
                  name="name"
                  value={newName}
                  onChange={(e) => handleNameChange(e.target.value)}
                  placeholder="Enter section name..."
                  required
                  minLength={3}
                />
                {isChecking && (
                  <Loader2 className="absolute right-3 top-2.5 h-4 w-4 animate-spin text-muted-foreground" />
                )}
              </div>
            </div>

            <DuplicateWarning similar={similar} />

            <div className="flex gap-2 justify-end">
              <Button
                type="button"
                variant="outline"
                onClick={() => setCreateOpen(false)}
              >
                Cancel
              </Button>
              <Button type="submit" disabled={isPending || newName.length < 3}>
                {isPending ? (
                  <>
                    <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                    Creating...
                  </>
                ) : (
                  "Create Section"
                )}
              </Button>
            </div>
          </form>
        </DialogContent>
      </Dialog>
    </div>
  );
}
```

IMPORTANT:
- Uses hidden input for form submission (name prop)
- Reuses existing createWSOSSectionAction from Phase 6
- Reuses DuplicateWarning component from Phase 6
- onSectionCreated callback allows parent to refresh sections list
  </action>
  <verify>File exists and TypeScript compiles with `npx tsc --noEmit`</verify>
  <done>WSOSSectionSelect component created with dropdown and inline creation dialog</done>
</task>

<task type="auto">
  <name>Task 2: Create My Descriptors list page with batch UI</name>
  <files>src/app/(dashboard)/hub/descriptors/my-descriptors/page.tsx</files>
  <action>
Create new file `src/app/(dashboard)/hub/descriptors/my-descriptors/page.tsx`:

```typescript
import { DescriptorBatchStatus } from "@prisma/client";
import Link from "next/link";
import { redirect } from "next/navigation";
import { ArrowLeft, Plus, Pencil, Trash2, Send, Clock, CheckCircle, AlertCircle } from "lucide-react";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { requireUser } from "@/lib/auth";
import { getSCMDescriptors } from "@/lib/scm-descriptors";
import { submitBatchAction, deleteSCMDescriptorAction } from "./actions";

const BATCH_STATUS_CONFIG: Record<DescriptorBatchStatus, { label: string; color: string; icon: typeof Clock }> = {
  [DescriptorBatchStatus.DRAFT]: {
    label: "Draft",
    color: "bg-gray-100 text-gray-800",
    icon: Clock,
  },
  [DescriptorBatchStatus.PENDING_REVIEW]: {
    label: "Pending Review",
    color: "bg-amber-100 text-amber-800",
    icon: Clock,
  },
  [DescriptorBatchStatus.APPROVED]: {
    label: "Approved",
    color: "bg-green-100 text-green-800",
    icon: CheckCircle,
  },
  [DescriptorBatchStatus.RETURNED]: {
    label: "Returned",
    color: "bg-red-100 text-red-800",
    icon: AlertCircle,
  },
};

export default async function MyDescriptorsPage({
  searchParams,
}: {
  searchParams?: {
    created?: string;
    updated?: string;
    deleted?: string;
    submitted?: string;
    error?: string;
  };
}) {
  const user = await requireUser();

  // Only SCMs can access this page
  if (user.role !== "SCM") {
    redirect("/dashboard");
  }

  const allDescriptors = await getSCMDescriptors(user.id);

  // Group by batch status
  const draftDescriptors = allDescriptors.filter(
    (d) => d.batchStatus === DescriptorBatchStatus.DRAFT
  );
  const pendingDescriptors = allDescriptors.filter(
    (d) => d.batchStatus === DescriptorBatchStatus.PENDING_REVIEW
  );
  const approvedDescriptors = allDescriptors.filter(
    (d) => d.batchStatus === DescriptorBatchStatus.APPROVED
  );
  const returnedDescriptors = allDescriptors.filter(
    (d) => d.batchStatus === DescriptorBatchStatus.RETURNED
  );

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-4">
          <Button asChild variant="ghost" size="sm">
            <Link href="/hub/descriptors">
              <ArrowLeft className="mr-2 h-4 w-4" />
              Back to Library
            </Link>
          </Button>
        </div>
        <Button asChild>
          <Link href="/hub/descriptors/my-descriptors/create">
            <Plus className="mr-2 h-4 w-4" />
            Create Descriptor
          </Link>
        </Button>
      </div>

      <div>
        <h1 className="text-3xl font-semibold tracking-tight">My Descriptors</h1>
        <p className="mt-2 text-muted-foreground">
          Create and manage your descriptors. Submit batches for SA review.
        </p>
      </div>

      {/* Status messages */}
      {searchParams?.error && (
        <Card className="border-destructive bg-destructive/10">
          <CardContent className="py-4">
            <p className="text-sm text-destructive">{searchParams.error}</p>
          </CardContent>
        </Card>
      )}

      {searchParams?.created && (
        <Card className="border-green-500 bg-green-50 dark:bg-green-950">
          <CardContent className="py-4">
            <p className="text-sm text-green-700 dark:text-green-300">
              Descriptor created and added to draft batch.
            </p>
          </CardContent>
        </Card>
      )}

      {searchParams?.updated && (
        <Card className="border-green-500 bg-green-50 dark:bg-green-950">
          <CardContent className="py-4">
            <p className="text-sm text-green-700 dark:text-green-300">
              Descriptor updated successfully.
            </p>
          </CardContent>
        </Card>
      )}

      {searchParams?.deleted && (
        <Card className="border-green-500 bg-green-50 dark:bg-green-950">
          <CardContent className="py-4">
            <p className="text-sm text-green-700 dark:text-green-300">
              Descriptor deleted.
            </p>
          </CardContent>
        </Card>
      )}

      {searchParams?.submitted && (
        <Card className="border-green-500 bg-green-50 dark:bg-green-950">
          <CardContent className="py-4">
            <p className="text-sm text-green-700 dark:text-green-300">
              Batch submitted! {searchParams.submitted} descriptor(s) sent for SA review.
            </p>
          </CardContent>
        </Card>
      )}

      {/* Draft Batch Section */}
      <Card>
        <CardHeader className="flex flex-row items-center justify-between">
          <div>
            <CardTitle className="flex items-center gap-2">
              <Clock className="h-5 w-5 text-gray-500" />
              Draft Batch
            </CardTitle>
            <CardDescription>
              {draftDescriptors.length} descriptor(s) ready to submit for review
            </CardDescription>
          </div>
          {draftDescriptors.length > 0 && (
            <form action={submitBatchAction}>
              <Button type="submit">
                <Send className="mr-2 h-4 w-4" />
                Submit for Review
              </Button>
            </form>
          )}
        </CardHeader>
        <CardContent>
          {draftDescriptors.length === 0 ? (
            <p className="text-sm text-muted-foreground">
              No draft descriptors. Create one to get started.
            </p>
          ) : (
            <div className="space-y-3">
              {draftDescriptors.map((descriptor) => (
                <div
                  key={descriptor.id}
                  className="flex items-start justify-between gap-4 rounded-md border p-4"
                >
                  <div className="min-w-0 flex-1">
                    <div className="flex items-center gap-2 flex-wrap">
                      <Badge variant="outline">{descriptor.code}</Badge>
                      {descriptor.wsosSection && (
                        <Badge variant="secondary">{descriptor.wsosSection.name}</Badge>
                      )}
                    </div>
                    <h3 className="mt-2 font-medium">{descriptor.criterionName}</h3>
                    {descriptor.score3 && (
                      <p className="mt-1 text-sm text-muted-foreground line-clamp-2">
                        {descriptor.score3}
                      </p>
                    )}
                  </div>
                  <div className="flex gap-2">
                    <Button asChild variant="outline" size="sm">
                      <Link href={`/hub/descriptors/my-descriptors/${descriptor.id}/edit`}>
                        <Pencil className="h-4 w-4" />
                      </Link>
                    </Button>
                    <form action={deleteSCMDescriptorAction}>
                      <input type="hidden" name="id" value={descriptor.id} />
                      <Button type="submit" variant="outline" size="sm" className="text-destructive">
                        <Trash2 className="h-4 w-4" />
                      </Button>
                    </form>
                  </div>
                </div>
              ))}
            </div>
          )}
        </CardContent>
      </Card>

      {/* Returned Section (needs attention) */}
      {returnedDescriptors.length > 0 && (
        <Card className="border-red-200">
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <AlertCircle className="h-5 w-5 text-red-500" />
              Returned for Revision
            </CardTitle>
            <CardDescription>
              {returnedDescriptors.length} descriptor(s) returned by SA with comments
            </CardDescription>
          </CardHeader>
          <CardContent>
            <div className="space-y-3">
              {returnedDescriptors.map((descriptor) => (
                <div
                  key={descriptor.id}
                  className="flex items-start justify-between gap-4 rounded-md border border-red-200 p-4"
                >
                  <div className="min-w-0 flex-1">
                    <div className="flex items-center gap-2 flex-wrap">
                      <Badge variant="outline">{descriptor.code}</Badge>
                      <Badge className="bg-red-100 text-red-800">Returned</Badge>
                    </div>
                    <h3 className="mt-2 font-medium">{descriptor.criterionName}</h3>
                    {descriptor.reviewComment && (
                      <p className="mt-2 text-sm text-red-700 bg-red-50 p-2 rounded">
                        SA Comment: {descriptor.reviewComment}
                      </p>
                    )}
                  </div>
                  {/* Note: Edit functionality for returned items will be added in Phase 8 */}
                </div>
              ))}
            </div>
          </CardContent>
        </Card>
      )}

      {/* Pending Review Section */}
      {pendingDescriptors.length > 0 && (
        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <Clock className="h-5 w-5 text-amber-500" />
              Pending Review
            </CardTitle>
            <CardDescription>
              {pendingDescriptors.length} descriptor(s) awaiting SA approval
            </CardDescription>
          </CardHeader>
          <CardContent>
            <div className="space-y-3">
              {pendingDescriptors.map((descriptor) => (
                <div
                  key={descriptor.id}
                  className="flex items-start gap-4 rounded-md border p-4 bg-amber-50/50"
                >
                  <div className="min-w-0 flex-1">
                    <div className="flex items-center gap-2 flex-wrap">
                      <Badge variant="outline">{descriptor.code}</Badge>
                      {descriptor.wsosSection && (
                        <Badge variant="secondary">{descriptor.wsosSection.name}</Badge>
                      )}
                      <Badge className="bg-amber-100 text-amber-800">Pending Review</Badge>
                    </div>
                    <h3 className="mt-2 font-medium">{descriptor.criterionName}</h3>
                    {descriptor.submittedAt && (
                      <p className="mt-1 text-xs text-muted-foreground">
                        Submitted {new Date(descriptor.submittedAt).toLocaleDateString()}
                      </p>
                    )}
                  </div>
                </div>
              ))}
            </div>
          </CardContent>
        </Card>
      )}

      {/* Approved Section */}
      {approvedDescriptors.length > 0 && (
        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <CheckCircle className="h-5 w-5 text-green-500" />
              Approved
            </CardTitle>
            <CardDescription>
              {approvedDescriptors.length} descriptor(s) approved and added to library
            </CardDescription>
          </CardHeader>
          <CardContent>
            <div className="space-y-3">
              {approvedDescriptors.map((descriptor) => (
                <div
                  key={descriptor.id}
                  className="flex items-start gap-4 rounded-md border p-4 bg-green-50/50"
                >
                  <div className="min-w-0 flex-1">
                    <div className="flex items-center gap-2 flex-wrap">
                      <Badge variant="outline">{descriptor.code}</Badge>
                      {descriptor.wsosSection && (
                        <Badge variant="secondary">{descriptor.wsosSection.name}</Badge>
                      )}
                      <Badge className="bg-green-100 text-green-800">Approved</Badge>
                    </div>
                    <h3 className="mt-2 font-medium">{descriptor.criterionName}</h3>
                    {descriptor.reviewedAt && (
                      <p className="mt-1 text-xs text-muted-foreground">
                        Approved {new Date(descriptor.reviewedAt).toLocaleDateString()}
                      </p>
                    )}
                  </div>
                </div>
              ))}
            </div>
          </CardContent>
        </Card>
      )}
    </div>
  );
}
```

KEY FEATURES:
- Groups descriptors by batchStatus (BATCH-02: shows pending descriptors)
- Draft section has edit/delete buttons (BATCH-02)
- Submit for Review button calls submitBatchAction (BATCH-03)
- Success/error messages via query params
- SCM role check with redirect
  </action>
  <verify>File exists and TypeScript compiles</verify>
  <done>My Descriptors page created with batch workflow UI</done>
</task>

<task type="auto">
  <name>Task 3: Create descriptor creation page</name>
  <files>src/app/(dashboard)/hub/descriptors/my-descriptors/create/page.tsx</files>
  <action>
Create directory and file:
```bash
mkdir -p src/app/(dashboard)/hub/descriptors/my-descriptors/create
```

Create `src/app/(dashboard)/hub/descriptors/my-descriptors/create/page.tsx`:

```typescript
import Link from "next/link";
import { redirect } from "next/navigation";
import { ArrowLeft } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { requireUser } from "@/lib/auth";
import { getAllWSOSSections } from "@/lib/wsos-sections";
import { WSOSSectionSelect } from "@/components/descriptors/wsos-section-select";
import { createSCMDescriptorAction } from "../actions";

export default async function CreateDescriptorPage({
  searchParams,
}: {
  searchParams?: { error?: string };
}) {
  const user = await requireUser();

  // Only SCMs can access this page
  if (user.role !== "SCM") {
    redirect("/dashboard");
  }

  const sections = await getAllWSOSSections();

  return (
    <div className="space-y-6">
      <div className="flex items-center gap-4">
        <Button asChild variant="ghost" size="sm">
          <Link href="/hub/descriptors/my-descriptors">
            <ArrowLeft className="mr-2 h-4 w-4" />
            Back to My Descriptors
          </Link>
        </Button>
      </div>

      <div>
        <h1 className="text-3xl font-semibold tracking-tight">Create Descriptor</h1>
        <p className="mt-2 text-muted-foreground">
          Add a new descriptor to your draft batch. It will be submitted for SA review.
        </p>
      </div>

      {searchParams?.error && (
        <Card className="border-destructive bg-destructive/10">
          <CardContent className="py-4">
            <p className="text-sm text-destructive">{searchParams.error}</p>
          </CardContent>
        </Card>
      )}

      <Card>
        <CardHeader>
          <CardTitle>Descriptor Details</CardTitle>
          <CardDescription>
            All new descriptors require a WSOS section and will need SA approval before appearing in the library.
          </CardDescription>
        </CardHeader>
        <CardContent>
          <form action={createSCMDescriptorAction} className="space-y-6">
            {/* WSOS Section - Required (DESC-02, DESC-03) */}
            <div className="space-y-2">
              <Label htmlFor="wsosSectionId">
                WSOS Section <span className="text-destructive">*</span>
              </Label>
              <WSOSSectionSelect
                sections={sections}
                name="wsosSectionId"
                required
              />
              <p className="text-xs text-muted-foreground">
                Select an existing section or create a new one
              </p>
            </div>

            <div className="grid gap-4 sm:grid-cols-2">
              <div className="space-y-2">
                <Label htmlFor="code">
                  Code <span className="text-destructive">*</span>
                </Label>
                <Input
                  id="code"
                  name="code"
                  required
                  placeholder="A1"
                />
                <p className="text-xs text-muted-foreground">
                  Criterion code (e.g., A1, B2.1)
                </p>
              </div>

              <div className="space-y-2">
                <Label htmlFor="criterionName">
                  Criterion Name <span className="text-destructive">*</span>
                </Label>
                <Input
                  id="criterionName"
                  name="criterionName"
                  required
                  minLength={5}
                  placeholder="Quality of weld seam"
                />
              </div>
            </div>

            <div className="space-y-4">
              <h3 className="font-medium">Performance Levels</h3>
              <p className="text-sm text-muted-foreground">
                At least one performance level description is required.
              </p>

              <div className="grid gap-4 sm:grid-cols-2">
                <div className="space-y-2">
                  <Label htmlFor="score3">Score 3 (Excellent)</Label>
                  <Textarea
                    id="score3"
                    name="score3"
                    rows={4}
                    placeholder="Description for excellent performance..."
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="score2">Score 2 (Good)</Label>
                  <Textarea
                    id="score2"
                    name="score2"
                    rows={4}
                    placeholder="Description for good performance..."
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="score1">Score 1 (Pass)</Label>
                  <Textarea
                    id="score1"
                    name="score1"
                    rows={4}
                    placeholder="Description for passing performance..."
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="score0">Score 0 (Below Pass)</Label>
                  <Textarea
                    id="score0"
                    name="score0"
                    rows={4}
                    placeholder="Description for below passing..."
                  />
                </div>
              </div>
            </div>

            <div className="space-y-2">
              <Label htmlFor="tags">Tags</Label>
              <Input
                id="tags"
                name="tags"
                placeholder="safety, measurement, quality"
              />
              <p className="text-xs text-muted-foreground">
                Comma-separated tags for categorization
              </p>
            </div>

            <div className="flex gap-2">
              <Button type="submit">Save as Draft</Button>
              <Button asChild variant="outline">
                <Link href="/hub/descriptors/my-descriptors">Cancel</Link>
              </Button>
            </div>
          </form>
        </CardContent>
      </Card>
    </div>
  );
}
```

KEY FEATURES:
- WSOS section is required and first field (DESC-02)
- WSOSSectionSelect component with inline creation (DESC-03)
- Same fields as admin form (DESC-01): code, criterionName, performance levels, tags
- Clear messaging that descriptors need SA approval
  </action>
  <verify>File exists and TypeScript compiles</verify>
  <done>Create descriptor page created with WSOS section selector</done>
</task>

<task type="auto">
  <name>Task 4: Create descriptor edit page</name>
  <files>src/app/(dashboard)/hub/descriptors/my-descriptors/[id]/edit/page.tsx</files>
  <action>
Create directory structure and file:
```bash
mkdir -p "src/app/(dashboard)/hub/descriptors/my-descriptors/[id]/edit"
```

Create `src/app/(dashboard)/hub/descriptors/my-descriptors/[id]/edit/page.tsx`:

```typescript
import Link from "next/link";
import { notFound, redirect } from "next/navigation";
import { ArrowLeft } from "lucide-react";
import { DescriptorBatchStatus } from "@prisma/client";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { requireUser } from "@/lib/auth";
import { getAllWSOSSections } from "@/lib/wsos-sections";
import { getSCMDescriptorById } from "@/lib/scm-descriptors";
import { WSOSSectionSelect } from "@/components/descriptors/wsos-section-select";
import { updateSCMDescriptorAction } from "../../actions";

export default async function EditDescriptorPage({
  params,
  searchParams,
}: {
  params: { id: string };
  searchParams?: { error?: string };
}) {
  const user = await requireUser();

  // Only SCMs can access this page
  if (user.role !== "SCM") {
    redirect("/dashboard");
  }

  // Fetch descriptor with ownership check
  const descriptor = await getSCMDescriptorById(params.id, user.id);

  if (!descriptor) {
    notFound();
  }

  // Can only edit DRAFT descriptors
  if (descriptor.batchStatus !== DescriptorBatchStatus.DRAFT) {
    redirect("/hub/descriptors/my-descriptors?error=Only%20draft%20descriptors%20can%20be%20edited");
  }

  const sections = await getAllWSOSSections();

  return (
    <div className="space-y-6">
      <div className="flex items-center gap-4">
        <Button asChild variant="ghost" size="sm">
          <Link href="/hub/descriptors/my-descriptors">
            <ArrowLeft className="mr-2 h-4 w-4" />
            Back to My Descriptors
          </Link>
        </Button>
      </div>

      <div>
        <h1 className="text-3xl font-semibold tracking-tight">Edit Descriptor</h1>
        <p className="mt-2 text-muted-foreground">
          Update your draft descriptor before submitting for review.
        </p>
      </div>

      {searchParams?.error && (
        <Card className="border-destructive bg-destructive/10">
          <CardContent className="py-4">
            <p className="text-sm text-destructive">{searchParams.error}</p>
          </CardContent>
        </Card>
      )}

      <Card>
        <CardHeader>
          <CardTitle>Edit Descriptor</CardTitle>
          <CardDescription>
            Editing: {descriptor.code} - {descriptor.criterionName}
          </CardDescription>
        </CardHeader>
        <CardContent>
          <form action={updateSCMDescriptorAction} className="space-y-6">
            <input type="hidden" name="id" value={descriptor.id} />

            {/* WSOS Section - Required */}
            <div className="space-y-2">
              <Label htmlFor="wsosSectionId">
                WSOS Section <span className="text-destructive">*</span>
              </Label>
              <WSOSSectionSelect
                sections={sections}
                name="wsosSectionId"
                defaultValue={descriptor.wsosSectionId ?? ""}
                required
              />
            </div>

            <div className="grid gap-4 sm:grid-cols-2">
              <div className="space-y-2">
                <Label htmlFor="code">
                  Code <span className="text-destructive">*</span>
                </Label>
                <Input
                  id="code"
                  name="code"
                  required
                  defaultValue={descriptor.code}
                  placeholder="A1"
                />
              </div>

              <div className="space-y-2">
                <Label htmlFor="criterionName">
                  Criterion Name <span className="text-destructive">*</span>
                </Label>
                <Input
                  id="criterionName"
                  name="criterionName"
                  required
                  minLength={5}
                  defaultValue={descriptor.criterionName}
                  placeholder="Quality of weld seam"
                />
              </div>
            </div>

            <div className="space-y-4">
              <h3 className="font-medium">Performance Levels</h3>

              <div className="grid gap-4 sm:grid-cols-2">
                <div className="space-y-2">
                  <Label htmlFor="score3">Score 3 (Excellent)</Label>
                  <Textarea
                    id="score3"
                    name="score3"
                    rows={4}
                    defaultValue={descriptor.score3 ?? ""}
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="score2">Score 2 (Good)</Label>
                  <Textarea
                    id="score2"
                    name="score2"
                    rows={4}
                    defaultValue={descriptor.score2 ?? ""}
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="score1">Score 1 (Pass)</Label>
                  <Textarea
                    id="score1"
                    name="score1"
                    rows={4}
                    defaultValue={descriptor.score1 ?? ""}
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="score0">Score 0 (Below Pass)</Label>
                  <Textarea
                    id="score0"
                    name="score0"
                    rows={4}
                    defaultValue={descriptor.score0 ?? ""}
                  />
                </div>
              </div>
            </div>

            <div className="space-y-2">
              <Label htmlFor="tags">Tags</Label>
              <Input
                id="tags"
                name="tags"
                defaultValue={descriptor.tags.join(", ")}
                placeholder="safety, measurement, quality"
              />
            </div>

            <div className="flex gap-2">
              <Button type="submit">Update Descriptor</Button>
              <Button asChild variant="outline">
                <Link href="/hub/descriptors/my-descriptors">Cancel</Link>
              </Button>
            </div>
          </form>
        </CardContent>
      </Card>
    </div>
  );
}
```

KEY FEATURES:
- Uses getSCMDescriptorById with ownership check
- Redirects if not DRAFT status (can only edit drafts)
- Pre-populates all fields from existing descriptor
- Same form structure as create page
  </action>
  <verify>File exists and TypeScript compiles</verify>
  <done>Edit descriptor page created with DRAFT-only restriction</done>
</task>

</tasks>

<verification>
- [ ] `npx tsc --noEmit` passes
- [ ] WSOSSectionSelect component exists at src/components/descriptors/wsos-section-select.tsx
- [ ] My Descriptors page exists at src/app/(dashboard)/hub/descriptors/my-descriptors/page.tsx
- [ ] Create page exists at src/app/(dashboard)/hub/descriptors/my-descriptors/create/page.tsx
- [ ] Edit page exists at src/app/(dashboard)/hub/descriptors/my-descriptors/[id]/edit/page.tsx
- [ ] Dev server starts without errors
- [ ] Navigate to /hub/descriptors/my-descriptors shows page (as SCM user)
</verification>

<success_criteria>
- SCM can view My Descriptors page with grouped sections by status (BATCH-02)
- Draft section shows edit/delete buttons for each descriptor (BATCH-02)
- Submit for Review button visible when drafts exist (BATCH-03)
- Create form has mandatory WSOS section dropdown (DESC-02)
- Create form has inline section creation option (DESC-03)
- Edit page only works for DRAFT status descriptors
- All pages have SCM role check
- Success/error messages display properly
</success_criteria>

<output>
After completion, create `.planning/phases/07-scm-descriptor-creation-batch-workflow/07-04-SUMMARY.md`
</output>
