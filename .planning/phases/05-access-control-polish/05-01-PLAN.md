---
phase: 05-access-control-polish
plan: 01
type: execute
wave: 1
depends_on: ["04-03"]
files_modified:
  - src/app/(dashboard)/hub/descriptors/page.tsx
  - src/app/(dashboard)/hub/descriptors/components/* (moved)
  - src/components/hub/hub-nav.tsx
autonomous: true

must_haves:
  truths:
    - "Descriptor library requires authentication"
    - "SCMs, SAs, SkillTeam, Secretariat can access library"
    - "Library appears in Hub navigation"
    - "Admin curation remains at /settings/descriptors"
  artifacts:
    - path: "src/app/(dashboard)/hub/descriptors/page.tsx"
      provides: "Protected descriptor library page"
      min_lines: 30
    - path: "src/components/hub/hub-nav.tsx"
      provides: "Hub nav with Descriptor Library link"
      contains: "descriptors"
---

<objective>
Move descriptor library under authenticated routes and add to navigation

Purpose: Integrate descriptor library into existing permission structure (ACCESS-01 through ACCESS-04)
Output: Library at /hub/descriptors with auth, link in hub navigation
</objective>

<context>
The existing dashboard layout at (dashboard)/layout.tsx:
- Requires authentication (redirects to /login if no user)
- Requires non-Pending role (redirects to /awaiting-access)
- Hub is accessible to SA, SCM, SkillTeam, Secretariat, and Admin

Admin curation pages exist at /settings/descriptors (admin-only via Settings nav check)

Current public library at /descriptors needs to move under (dashboard)/hub/descriptors
</context>

<tasks>

<task type="auto">
  <name>Task 1: Move descriptor library to hub route</name>
  <files>src/app/(dashboard)/hub/descriptors/*</files>
  <action>
Move the entire /descriptors directory to /hub/descriptors:

1. Create new directory structure:
   - src/app/(dashboard)/hub/descriptors/
   - src/app/(dashboard)/hub/descriptors/components/

2. Move files:
   - page.tsx
   - components/SearchInput.tsx
   - components/FilterPanel.tsx
   - components/Pagination.tsx
   - components/DescriptorList.tsx
   - components/DescriptorModal.tsx
   - components/ComparisonBar.tsx
   - components/ComparisonModal.tsx

3. Delete the old /descriptors directory

The page will now inherit authentication from (dashboard)/layout.tsx
and role checks from hub/layout.tsx (SA, SCM, SkillTeam, Secretariat, Admin)
  </action>
  <verify>
Directory exists at src/app/(dashboard)/hub/descriptors/
Old /descriptors directory removed
  </verify>
  <done>Descriptor library moved to authenticated hub route</done>
</task>

<task type="auto">
  <name>Task 2: Add Descriptor Library to Hub navigation</name>
  <files>src/components/hub/hub-nav.tsx</files>
  <action>
Add the Descriptor Library link to the hub navigation:

1. Import Library icon from lucide-react
2. Add nav item for descriptors:

```typescript
{ href: "/hub/descriptors", label: "Descriptor Library", icon: Library },
```

Place it after Knowledge Base in the nav order.
  </action>
  <verify>
HubNav shows Descriptor Library link.
Link navigates to /hub/descriptors.
  </verify>
  <done>Hub navigation updated with Descriptor Library link</done>
</task>

<task type="auto">
  <name>Task 3: Verify access control</name>
  <files>None (verification only)</files>
  <action>
Verify the access control is working:

1. Page requires authentication (dashboard layout check)
2. Non-Pending users can access (dashboard layout check)
3. Hub-accessible roles can view (hub layout check):
   - SA (Skill Advisor) - ACCESS-03
   - SCM (Skill Competition Manager) - ACCESS-01
   - SkillTeam
   - Secretariat
   - Admin

4. Admin curation at /settings/descriptors still works (admin-only)

The existing layout checks handle all access control automatically.
  </action>
  <verify>
Page returns 200 at /hub/descriptors (when logged in).
TypeScript compiles.
  </verify>
  <done>Access control verified</done>
</task>

</tasks>

<verification>
1. /hub/descriptors requires login (redirect to /login if not)
2. /hub/descriptors accessible to SA, SCM, SkillTeam, Secretariat, Admin
3. Pending users redirected to /awaiting-access
4. Descriptor Library appears in hub navigation
5. All existing functionality works (search, filter, modal, compare)
6. Admin can still access /settings/descriptors for curation
</verification>

<success_criteria>
- Library integrated into authenticated routes (ACCESS-01, ACCESS-03)
- Admin curation accessible (ACCESS-02)
- Uses existing permission patterns (ACCESS-04)
- Library in navigation (success criteria #5)
</success_criteria>

<output>
After completion, create `.planning/phases/05-access-control-polish/05-01-SUMMARY.md`
</output>
